<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
      
    <meta name="twitter:title" content="Knight's Quest">
    <meta name="twitter:description" content="Knight's Quest">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:image" content="https://altelus1.github.io/writeups/ctf/huntressctf2024/img/knightsquest/1.png" />
    
    <meta property="og:image" content="/writeups/ctf/huntressctf2024/img/knightsquest/1.png">
    <meta property="og:description" content="Knight's Quest">
    <title>Knight's Quest</title><!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Knight’s Quest" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/writeups/ctf/huntressctf2024/knightsquest.html" />
<meta property="og:url" content="http://localhost:4000/writeups/ctf/huntressctf2024/knightsquest.html" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Knight’s Quest" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","headline":"Knight’s Quest","url":"http://localhost:4000/writeups/ctf/huntressctf2024/knightsquest.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" type="text/css" href="/assets/main-dark.css"></head>


<body>
    <div class="container"><header>
  <div class="menu">
    <ul><li><a href="/">Home</a></li><li><a href="/about.html">About</a></li><li><a href="/writeups/">Writeups</a></li><li><a href="/projects/">Projects</a></li></ul>
  </div>
</header>
<main>
      <h1 id="reversing-knights-quest">[Reversing] Knight’s Quest</h1>
<p>The following challenge description has been given:<br />
<img src="img/knightsquest/1.png" alt="lol it didn't load" /><br />
Once the challenge is started, we can access the website. Here is the landing page:<br />
<img src="img/knightsquest/1.5.png" alt="lol it didn't load" /><br />
It instructs us to play the game and win to get the password to get the flag. We can download the game in the “downloads page” to play the game.<br />
We downloaded the file.<br />
<img src="img/knightsquest/2.png" alt="lol it didn't load" /><br />
We run the binary and we tried to play the game.<br />
<img src="img/knightsquest/3.png" alt="lol it didn't load" /><br />
The first boss is a spider:<br />
<img src="img/knightsquest/4.png" alt="lol it didn't load" /><br />
The second boss is a ogre:<br />
<img src="img/knightsquest/5.png" alt="lol it didn't load" /><br />
The last boss is Gorthmog, Destroyer of worlds with ridiculously health and attack points:<br />
<img src="img/knightsquest/6.png" alt="lol it didn't load" /><br />
Of course we lost that one. One of the ways we can defeat Gorthmog is to have a very high attack power as well or if we can just reduce the health points to 1. We proceeded with the latter. The plan is if the health points is already hardcoded within the game binary, perhaps we can patch it to only set it to 1. So we get the hex value of the Gorthmog’s health points.<br />
<img src="img/knightsquest/7.png" alt="lol it didn't load" /><br />
It’s 0x3b9ac9ff. We opened the binary to hexed.it and find the byte sequence <code class="language-plaintext highlighter-rouge">ff c9 9a 3b</code> and and set it to <code class="language-plaintext highlighter-rouge">01 00 00 00</code>. We actually found it<br />
<img src="img/knightsquest/8.png" alt="lol it didn't load" /><br />
Then we patched it.<br />
<img src="img/knightsquest/9.png" alt="lol it didn't load" /><br />
We saved the patched game and replayed it. After defeating the first two bosses, we can see the Gorthmog’s health points is just 1 now. This is sure win since we always get to attack first.<br />
<img src="img/knightsquest/10.png" alt="lol it didn't load" /><br />
We got the password.<br />
<img src="img/knightsquest/11.png" alt="lol it didn't load" /><br />
We submitted it to the challenge URL and got the flag.<br />
<img src="img/knightsquest/12.png" alt="lol it didn't load" /><br /></p>


    </main><footer>
  
</footer>
</div>
  </body>
</html>
