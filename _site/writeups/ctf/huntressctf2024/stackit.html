<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
      
    <meta name="twitter:title" content="Stack It">
    <meta name="twitter:description" content="Stack It">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:image" content="https://altelus1.github.io/writeups/ctf/huntressctf2024/img/stack_it/1.png" />
    
    <meta property="og:image" content="/writeups/ctf/huntressctf2024/img/stack_it/1.png">
    <meta property="og:description" content="Stack It">
    <title>Stack It</title><!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Stack It" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/writeups/ctf/huntressctf2024/stackit.html" />
<meta property="og:url" content="http://localhost:4000/writeups/ctf/huntressctf2024/stackit.html" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Stack It" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","headline":"Stack It","url":"http://localhost:4000/writeups/ctf/huntressctf2024/stackit.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" type="text/css" href="/assets/main-dark.css"></head>


<body>
    <div class="container"><header>
  <div class="menu">
    <ul><li><a href="/">Home</a></li><li><a href="/about.html">About</a></li><li><a href="/writeups/">Writeups</a></li><li><a href="/projects/">Projects</a></li></ul>
  </div>
</header>
<main>
      <h1 id="reversing-stack-it">[Reversing] Stack It</h1>
<p>The following challenge description has been given:<br />
<img src="img/stack_it/1.png" alt="lol it didn't load" /><br />
Below is the file type:<br />
<img src="img/stack_it/1.5.png" alt="lol it didn't load" /><br />
Opening up Ghidra and analyzing the stack_it.bin, below is what we concluded.<br />
<img src="img/stack_it/2.png" alt="lol it didn't load" /><br />
The initialized two byte arrays were identified and extracted the hex contents.<br />
Byte array 1:<br />
<img src="img/stack_it/3.png" alt="lol it didn't load" /><br />
Byte array 2:<br />
<img src="img/stack_it/4.png" alt="lol it didn't load" /><br />
We then XOR them together and got the flag. The following code has been used:
<br /></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"1.txt"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">rf</span><span class="p">:</span>
    <span class="n">one</span> <span class="o">=</span> <span class="n">rf</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">strip</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"2.txt"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">rf</span><span class="p">:</span>
    <span class="n">two</span> <span class="o">=</span> <span class="n">rf</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">strip</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"flag{"</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">one</span><span class="p">)):</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">one</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">16</span><span class="p">)</span> <span class="o">^</span> <span class="nb">int</span><span class="p">(</span><span class="n">two</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">16</span><span class="p">)),</span><span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"}"</span><span class="p">)</span>
</code></pre></div></div>
<p><br /><img src="img/stack_it/5.png" alt="lol it didn't load" /><br />
<img src="img/stack_it/6.png" alt="lol it didn't load" /><br /></p>


    </main><footer>
  
</footer>
</div>
  </body>
</html>
